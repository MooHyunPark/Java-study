


<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Index</title>
</head>
<body>
	<jsp:include page="module.jsp"></jsp:include> <!-- module.jsp의 내용을 읽어와서 출력함 -->
	<p>홈페이지 소개 내용</p>
	<nav>
		<a href="page.jsp">컨텐츠 보기</a>
	</nav>
	<jsp:include page="module2.jsp"></jsp:include>
</body>
</html>





인코드

<%@page import="java.net.URLEncoder"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Page</title>
</head>
<body>
	<%
		//주소에는 한글이 들어갔을 때 제대로 읽을 수 없기 때문에 % encode 방식을 사용해야 한다.
		String encode = URLEncoder.encode("페이지 상세내용은 다음과 같습니다", "UTF-8"); 
	%>
	<%-- 다른 페이지를 불러올 때 특정 파라미터의 이름과 값을 함께 보내준다. --%>
	<jsp:include page="module.jsp">
		<jsp:param name="description" value="<%= encode %>"/>
	</jsp:include>
	<article>
		<h1>글 제목</h1>
		<p>컨텐츠 내용</p>
	</article>
	<jsp:include page="module2.jsp"></jsp:include>
</body>
</html>



디코드


<%@page import="java.net.URLDecoder"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%
	String description = request.getParameter("description");
	String decode = null;
	if (description != null) {
		decode = URLDecoder.decode(description, "UTF-8");
	}
	
%>

<header>
	<h1>홈페이지에 오신걸 환영합니다.</h1>
	<% 
		if (description != null) {
			out.println("<h2>" + decode + "</h2>");
		}
 	%>
</header>









단순한 문자열 값이 아닌 더 구체적이고 복잡한 값이면 
파라미터로 모든 값을 주고 받기 힘들다.


<%
request.setAttribute("ad", "스마트 사용자");
%>
<jsp:include page="module3.jsp"></jsp:include>


<%
String ad = (String) request.getAttribute("ad");
if (ad.equals("스마트 사용자")) {
%>

와 같이 request 객체를 사용할 수 있다.
(키값, 밸류값)


다만 redirect를 통해 새 요청을 하게 되면 request도 다른 새 객체가 되기 때문에
request를 활용하면서 다른 페이지를 열어야 하는 경우
<jsp:forward page="third.jsp"></jsp:forward>와 같이 작성하여야 한다.
(새 요청을 하는 것이 X, 처리 흐름을 이어간다)

또는 
request.getRequestDispatcher("third.jsp").forward(request, response);







쿠키 만들기
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>로그인 성공</title>
</head>
<body>
	<%
		// Cookie는 key, value의 쌍으로 이루어져 있음
		Cookie cookie = new Cookie("login", "success");
		// 특별한 만료기한을 주지 않는다면 브라우저를 닫았을 때 쿠키는 사라진다.
		// 쿠키는 사용자가 임의로 조작할 수 있기 때문에 민감정보를 담으면 안된다.
		cookie.setMaxAge(60 * 60 * 24);
		response.addCookie(cookie);
	%>
	<p>로그인에 성공했습니다</p>
	<a href="onlyForLoginUser.jsp">로그인을 한 유저만을 위한 페이지</a>

</body>
</html>

쿠키 확인하기

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>로그인을 한 유저를 위한 페이지</title>
</head>
<body>

	<%
	
	Cookie[] cookies = request.getCookies();
	String login = null;
	for (Cookie c : cookies) {
		String cookieName = c.getName();
		if (cookieName.equals("login")) {
			login = c.getValue();
		}
	}
	if (login != null && login.equals("success")) {
	%>
	<p>회원님 환영합니다</p>
	<%
		} else {
	%>
	<p>로그인 부터 수행해주세요</p>
	<%
		}
	%>

</body>
</html>





세션 만들기

session.setAttribute("login", "success");


세션 확인하기


<%
	String login = (String) session.getAttribute("login");
	if (login != null && login.equals("success")) {
		out.println("<h1>로그인 상태값 확인</h1>");
	} else {
		out.println("<h1>세션에 값 없음</h1>");
	}
%>
쿠키 : 브라우저에 저장 (사용자가 의도적으로 변경할 가능성 존재)
세션 : 서버에 저장 (보안성 좋음, 사용자가 조작 불가능)

세션의 만료 기한은 마지막 통신 시간을 기준으로 정해진다
(tomcat기본 만료시간은 30분이다)


//session.removeAttribute("B"); 특정 키 값의 세션 정보를 제거
//session.invalidate(); // 모든 세션 정보를 제거




